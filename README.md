# PL-SEM-in-R - Sample data

## PL-SEM with Sample data provided with the booK: Partial Least Squares Structural Equation Modeling (PLS-SEM) Using R ######
## by Joseph Hair, Tomas Hult, Christian M. Ringle, Marko Sarstedt, Nicholas Danks, and Soumya Ray.#####

### 1. Installing and loading the package
##### Import the libary
library(seminr)
##### Load the data from the seminr package
corp_rep_data <- seminr::corp_rep_data
#### Alternatively, you can load the data if available in a file in a folder
#### corp_rep_data <- read.csv(file = "Corporate Reputation Data.csv", 
####  header = TRUE, sep = ";")

#### Take a quick look at the data with
head(corp_rep_data)

## Model and measurement details
## Variables in the data #To be created as a table 
## Tab. 1 Measurement details for the simple corporate reputation model.
**construct	variable name	item
Competence (COMP)	comp_1	[The company] is a top competitor in its market.
Competence (COMP)	comp_2	As far as I know, [the company] is recognized worldwide.
Competence (COMP)	comp_3	I believe that [the company] performs at a premium level.
Likeability (LIKE)	like_1	[The company] is a company that I can better identify with than other companies.
Likeability (LIKE)	like_2	[The company] is a company that I would regret more not having if it no longer existed than I would other companies.
Likeability (LIKE)	like_3	I regard [the company] as a likeable company.
Customer Satisfaction (CUSA)	cusa	I am satisfied with [the company].
Customer Loyalty (CUSL)	cusl_1	I would recommend [company] to friends and relatives.
Customer Loyalty (CUSL)	cusl_2	If I had to choose again, I would choose [company] as my mobile phone services provider.
Customer Loyalty (CUSL)**

`# The constructs() function specifies the list of all construct measurement models. Within this list you can define various constructs`
`# composite() specifies the measurement of individual constructs.`
`# interaction_term() specifies interactions terms.`
`# higher_composite() specifies hierarchical component models, i.e. higher-order constructs (Sarstedt et al., 2019)`

# composite() specifies the measurement of individual constructs and
# multi_items() creates a vector of multiple measurement items with similar names.
# single_item() describe a single measurement item.

### 2. Create a measurement model
corp_rep_mm <- constructs(
  composite("COMP", multi_items("comp_", 1:3)),
  composite("LIKE", multi_items("like_", 1:3)),
  composite("CUSA", single_item("cusa")),
  composite("CUSL", multi_items("cusl_", 1:3)))

### 3. Create a structural model
` ############ The structural model indicates the sequence of the constructs and the relationships between them.` 
`############# relationships() specifies all the structural relationships between all constructs.`
`########### paths() specifies relationships between a specific set of antecedents and outcomes.`

corp_rep_sm <- relationships(
  paths(from = c("COMP", "LIKE"), to = c("CUSA", "CUSL")),
  paths(from = c("CUSA"), to = c("CUSL")))

### 4. Estimating the model

`###### To estimate a PLS path model, algorithmic options and arguments settings must be selected. `
`###### These can be reviewed by calling the function’s documentation with ?estimate_pls`

`## Here, we specify the data (data = corp_rep_data), 
the measurement model (measurement_model = corp_rep_mm) and structural model (structural_model  = corp_rep_sm) as well as
the weighting scheme (inner_weights = path_weighting) and missing data handling with missing values being indicated by “-99” (missing_value = "-99") and
replaced by the mean (missing = mean_replacement).`

corp_rep_pls_model <- estimate_pls(data = corp_rep_data,
  measurement_model = corp_rep_mm,
  structural_model  = corp_rep_sm,
  inner_weights = path_weighting,
  missing = mean_replacement,
  missing_value = "-99")
`## Generating the seminr model
##All 344 observations are valid.`

### 5. Summarizing the model
` # Once the model has been estimated, a summarized report of the results can be generated by using the summary() function.`
summary_corp_rep <- summary(corp_rep_pls_model)

`# The summary() function applied to a SEMinR model object produces a summary.seminr_model class object. 
#Its sub-objects (see Tab. 2) serve as basis for the assessment of the measurement and structural model (Hair et al., 2019).`


## Objects available in the usmmary summary.seminr_model class object produced by the summary() function. To be created as a table
**Tab. 2 Elements of the summary.seminr_model object.
Sub-object	Content
meta	The estimation function and version information.
iterations	The number of iterations for the PLS algorithm to converge.
paths	The model’s path coefficients and (adjusted) R2 values.
total_effects	The model’s total effects.
total_indirect_effects	The model’s total indirect effects.
loadings	The outer loadings for all constructs.
weights	The outer weights for all constructs.
validity	The metrics necessary to evaluate the construct measures’ validity.
reliability	The metrics necessary to evaluate the construct measures’ reliability.
composite_scores	The estimated scores for constructs.
vif_antecedents	The metrics used to evaluate structural model collinearity.
fSquare	The f2 metric for all structural model relationships.
descriptives	The descriptive statistics of the indicator data.
it_criteria	The Information Theoretic model selection criteria for the estimated model.**

#### calling summary_corp_rep$paths, we inspect the model’s path coefficients and the (adjusted) R2 values 
summary_corp_rep$paths

#### calling summary_corp_rep$reliability, we inspect the construct reliability metrics
summary_corp_rep$reliability

#### we can plot the reliability
plot(summary_corp_rep$reliability)
#### calling summary_corp_rep$validity$fl_criteria, we obtain Discriminant validty, specifically, Fornell-Larcker criterion (Fornell & Larcker, 1981)
summary_corp_rep$validity$fl_criteria

#### Calling summary_corp_rep$validity$htmt, we inspect heterotrait-monotrait ratio (HTMT)
summary_corp_rep$validity$htmt


`# We recommend the heterotrait-monotrait ratio (HTMT) of the correlations to assess discriminant validity (Henseler et al., 2015).
The HTMT is the mean value of the indicator correlations across constructs (i.e., the heterotrait-heteromethod correlations) relative to the (geometric) mean of the average correlations for the indicators measuring the same construct (i.e., the monotrait-heteromethod correlations).
Discriminant validity problems are present when HTMT values
exceed 0.90 for constructs that are conceptually very similar.
exceed 0.85 for constructs that are conceptually more distinct.`
### Calling summary_corp_rep$vif_antecedents, we inspect the VIF for collinerity
summary_corp_rep$vif_antecedents

#### check if and when the algorithm converged, we can inspect the number of iterations in summary_corp_rep$iterations.
summary_corp_rep$iterations
#### We can access summary statistics such as mean, standard deviation and number of missing values for the model’s items
summary_corp_rep$descriptives$statistics$items

#### To get the construct statistics.
summary_corp_rep$descriptives$statistics$constructs

## 6. Bootstrapping the model
`# In PLS-SEM, we need to perform bootstrapping to estimate standard errors and compute confidence intervals.`
`We run the bootstrapping with the bootstrap_model() function with 1,000 (or any other number) subsamples (nboot = 1000) and set a seed (seed = 123) to obtain reproducible results.`

`# Next, we summarize the bootstrap model with sum_boot_corp_rep <- summary(boot_corp_rep)`

Copyboot_corp_rep <- bootstrap_model(seminr_model = corp_rep_pls_model,
  nboot = 1000,
  cores = NULL,
  seed = 123)
sum_boot_corp_rep <- summary(boot_corp_rep)

#### Obtain results on model estimates such as the path coefficients with sum_boot_corp_rep$bootstrapped_paths.
sum_boot_corp_rep$bootstrapped_paths


***The summary.boot_seminr_model object, i.e. sum_boot_corp_rep, contains the following sub-objects (Tab. 3): #To be created as table
Tab. 3 Elements of the summary.boot_seminr_model object.
Sub-object	Content
nboot	The number of bootstrap subsamples generated during bootstrapping.
bootstrapped_paths	The bootstrap estimated standard error, T statistic, and confidence intervals for the path coefficients.
bootstrapped_weights	The bootstrap estimated standard error, T statistic, and confidence intervals for the indicator weights.
bootstrapped_loadings	The bootstrap estimated standard error, T statistic, and confidence intervals for the indicator loadings.
bootstrapped_HTMT	The bootstrap estimated standard error, T statistic, and confidence intervals for the HTMT values.
bootstrapped_total_paths	The bootstrap estimated standard error, T statistic, and confidence intervals for the model’s total effects.***


# Mediation Analysis
